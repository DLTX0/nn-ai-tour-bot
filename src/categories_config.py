"""
Конфигурация категорий интересов для классификации запросов к 2GIS.
"""

from typing import Dict, List, Tuple

# Все поддерживаемые категории
ALL_CATEGORIES = [
    "history", "art", "food", "views", "parks", "entertainment",
    "religion", "sports", "shopping", "kids", "nature", "culture", "nightlife", "education", "street_art"
]

# Правила для heuristic fallback: (ключевые_слова, категория, запросы_для_2gis)
HEURISTIC_RULES: List[Tuple[List[str], str, List[str]]] = [
    # История
    (["истор", "кремль"], "history", ["Нижегородский кремль", "музей", "памятник", "исторический центр"]),
    
    # Религия
    (["церков", "храм", "собор", "монастыр", "религи", "православ"], "religion", 
     ["церковь", "храм", "собор", "монастырь"]),
    
    # Искусство
    (["искус", "арт", "галер", "выстав"], "art", 
     ["галерея", "выставка", "музей искусств", "арт-пространство"]),
    
    # Парки (без еды)
    (["парк", "сквер", "сад", "лесопарк", "гуля", "прогул"], "parks",
     ["парк", "сквер", "ботанический сад", "городской парк", "лесопарк"]),
    
    # Виды: панорамы, смотровые
    (["панора", "вид", "смотор", "обзор"], "views",
     ["смотровая площадка", "панорама", "набережная", "обзорная площадка"]),
    
    # Виды: реки, набережные, мосты
    (["река", "реки", "мост", "мосты", "закат", "вода", "у воды", "через реку"], "views",
     ["набережная", "Верхне-Волжская набережная", "Нижне-Волжская набережная", 
      "набережная Федоровского", "набережная Гребного канала", "мост", "пешеходный мост"]),
    
    # Виды: канатная дорога (добавляем набережные т.к. связано с переправой через реку)
    (["канатн", "фуникул", "переправ", "подвесн"], "views",
     ["канатная дорога", "набережная", "Верхне-Волжская набережная", "Нижне-Волжская набережная", 
      "смотровая площадка", "Чкаловская лестница"]),
    
    # Развлечения: кино, концерты
    (["кино", "концерт", "развлеч"], "entertainment",
     ["кинотеатр", "концертный зал"]),
    
    # Развлечения: наука, интерактивные музеи
    (["наука", "интерактивн", "научн", "планетар", "эксперимент"], "entertainment",
     ["интерактивный музей", "музей науки", "научный центр", "планетарий"]),
    
    # Ночная жизнь
    (["клуб", "ночн", "танц", "диско", "караоке"], "nightlife",
     ["клуб", "ночной клуб", "бар", "караоке"]),
    
    # Спорт
    (["спорт", "стадион", "бассейн", "фитнес", "активн"], "sports",
     ["стадион", "спортивный комплекс", "бассейн", "фитнес-центр"]),
    
    # Шопинг
    (["шопинг", "покупк", "магазин", "торговый центр", "тц", "рынок"], "shopping",
     ["торговый центр", "рынок", "магазин сувениров"]),
    
    # Дети
    (["дет", "ребен", "семь", "аттракцион", "зоопарк"], "kids",
     ["детский парк", "аттракционы", "зоопарк", "детский центр"]),
    
    # Природа
    (["природ", "лес", "заповедн", "экотроп", "экологи"], "nature",
     ["заповедник", "лес", "экотропа", "природный парк"]),
    
    # Культура
    (["культур", "филармони", "библиотек"], "culture",
     ["театр", "филармония", "дом культуры", "библиотека"]),
    
    # Образование
    (["образован", "университет", "учеб", "лекци"], "education",
     ["университет", "научный центр", "музей истории"]),

    # Стрит-арт
    (["стрит-арт", "street art", "графф", "мурал", "муралы", "рисунок на стене"], "street_art",
     ["стрит-арт", "граффити", "мурал"]),

    (["военн&тех", "военн&музе", "военн&оруж"], "history",
     ["музей военной техники", "военный музей"]),
    (["архитектур&век", "конструктивизм", "советск&архитектур", "модерн"], "art",
     ["архитектура XX века", "конструктивизм"]),
 ]

# Специальные правила с условиями
FOOD_KEYWORDS = [
    "еда", "ресто", "кафе", "кофе", "вкусн", "куш", "поесть", "есть", 
    "обед", "ужин", "завтрак", "фастфуд", "street food", "бургер", "пицц", "суши", "бар", "перекус"
]

PARK_KEYWORDS = ["парк", "сквер", "сад", "лесопарк", "гуля", "прогул"]

# Дефолтные категории если ничего не найдено
DEFAULT_CATEGORIES = {
    "history": ["музей", "памятник"],
    "art": ["галерея"],
    "views": ["набережная"],
    "parks": ["парк"],
    "entertainment": ["театр"],
    "street_art": ["стрит-арт", "граффити"],
}

SYSTEM_PROMPT = """Ты классифицируешь интересы пользователя в короткие поисковые запросы для 2ГИС (Нижний Новгород).
Верни ТОЛЬКО JSON с ключами: history, art, food, views, parks, entertainment, religion, sports, shopping, kids, nature, culture, nightlife, education, street_art.
Значения — массивы очень коротких русских фраз (1–2 слова) для поиска.

ПРАВИЛА КЛАССИФИКАЦИИ:
• food → ['ресторан','кафе','кофейня','бар'] — еда, рестораны, кафе, вкусно поесть
• history → ['Нижегородский кремль','музей','памятник','исторический центр'] — история, исторические места, кремль, памятники
• history → ['военный музей','музей военной техники'] — ТОЛЬКО если явно 'военная техника' или 'военный музей'
• religion → ['церковь','храм','собор','монастырь'] — церкви, храмы, религиозные места, барокко/готика (архитектура храмов)
• art → ['галерея','выставка','музей искусств','арт-пространство'] — искусство, галереи, выставки
• art → ['архитектура XX века','конструктивизм','советская архитектура'] — архитектура, конструктивизм
• parks → ['парк','сквер','ботанический сад','городской парк'] — парки, скверы, зеленые зоны, прогулки
• nature → ['заповедник','лес','экотропа','природный парк'] — природа, заповедники, леса, экология
• views → ['набережная','бульвар','мост','смотровая площадка','панорама','канатная дорога'] — виды, панорамы, набережные, мосты, реки, канатная дорога
• entertainment → ['интерактивный музей','музей науки','планетарий','экспериментариум'] — наука, техника (НЕ военная!), интерактивные музеи
• entertainment → ['кинотеатр','театр','концертный зал'] — кино, театры, концерты
• nightlife → ['клуб','бар','караоке','ночной клуб'] — ночная жизнь, клубы, бары, танцы
• sports → ['стадион','спортивный комплекс','бассейн','фитнес'] — спорт, активный отдых, стадионы
• shopping → ['торговый центр','рынок','магазин сувениров'] — шопинг, покупки, торговые центры
• kids → ['детский парк','аттракционы','зоопарк','детский центр'] — дети, семейный отдых, аттракционы
• culture → ['театр','библиотека','дом культуры','филармония'] — культура, театры, филармонии
• education → ['университет','музей истории','научный центр'] — образование, университеты, обучение
• street_art → ['стрит-арт','граффити','мурал'] — уличное искусство, граффити, художественные муралы

ВАЖНО:
• 'наука и техника' + 'интерактивный' → entertainment, НЕ history!
• 'военная техника' → history
• 'церковь', 'храм', 'собор' → religion, НЕ history
• 'парк'/'гулять' → parks, НЕ добавляй food
• 'лес', 'природа' → nature, НЕ parks
• 'клуб', 'бар' (ночной) → nightlife, НЕ entertainment
• 'канатная дорога', 'переправа', 'через реку' → views: ['канатная дорога','набережная']
• 'река', 'вода', 'набережная' → views: ['набережная','Верхне-Волжская набережная','Нижне-Волжская набережная','Федоровского набережная','набережная Гребного канала']

Верни только JSON без пояснений."""

